{"ast":null,"code":"import { finalize, switchMap, take, catchError, tap } from 'rxjs/operators';\nimport { EMPTY } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/todo.service\";\nimport * as i2 from \"@angular/router\";\n\nfunction TodoDetailComponent_div_0_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵelementStart(1, \"p\");\n    i0.ɵɵelementStart(2, \"strong\");\n    i0.ɵɵtext(3, \"Completed:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(5, 1, ctx_r3.todo.completedDate, \"medium\"), \"\");\n  }\n}\n\nfunction TodoDetailComponent_div_0_button_43_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function TodoDetailComponent_div_0_button_43_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return ctx_r6.toggleStatus();\n    });\n    i0.ɵɵelement(1, \"i\", 26);\n    i0.ɵɵtext(2, \" Mark Complete \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TodoDetailComponent_div_0_button_44_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function TodoDetailComponent_div_0_button_44_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return ctx_r8.toggleStatus();\n    });\n    i0.ɵɵelement(1, \"i\", 28);\n    i0.ɵɵtext(2, \" Mark Incomplete \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function (a0, a1) {\n  return {\n    \"completed-card\": a0,\n    \"pending-card\": a1\n  };\n};\n\nfunction TodoDetailComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵelementStart(1, \"div\", 4);\n    i0.ɵɵelementStart(2, \"div\", 5);\n    i0.ɵɵelementStart(3, \"h6\");\n    i0.ɵɵtext(4, \"View Todo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 6);\n    i0.ɵɵelementStart(6, \"div\", 7);\n    i0.ɵɵelementStart(7, \"h4\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 8);\n    i0.ɵɵelementStart(10, \"p\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\");\n    i0.ɵɵelementStart(13, \"p\");\n    i0.ɵɵelementStart(14, \"strong\");\n    i0.ɵɵtext(15, \"ID:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"span\", 9);\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"div\");\n    i0.ɵɵelementStart(19, \"p\");\n    i0.ɵɵelementStart(20, \"strong\");\n    i0.ɵɵtext(21, \"Status:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"span\", 10);\n    i0.ɵɵtext(23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 11);\n    i0.ɵɵelementStart(25, \"div\", 12);\n    i0.ɵɵelementStart(26, \"div\", 13);\n    i0.ɵɵelementStart(27, \"p\");\n    i0.ɵɵelementStart(28, \"strong\");\n    i0.ɵɵtext(29, \"Created:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(30);\n    i0.ɵɵpipe(31, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(32, TodoDetailComponent_div_0_div_32_Template, 6, 4, \"div\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(33, \"div\", 15);\n    i0.ɵɵelementStart(34, \"div\", 16);\n    i0.ɵɵelementStart(35, \"div\");\n    i0.ɵɵelementStart(36, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function TodoDetailComponent_div_0_Template_button_click_36_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.goBack();\n    });\n    i0.ɵɵelement(37, \"i\", 18);\n    i0.ɵɵtext(38, \" Back \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(39, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function TodoDetailComponent_div_0_Template_button_click_39_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.editTodo();\n    });\n    i0.ɵɵelement(40, \"i\", 20);\n    i0.ɵɵtext(41, \" Edit \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(42, \"div\");\n    i0.ɵɵtemplate(43, TodoDetailComponent_div_0_button_43_Template, 3, 0, \"button\", 21);\n    i0.ɵɵtemplate(44, TodoDetailComponent_div_0_button_44_Template, 3, 0, \"button\", 22);\n    i0.ɵɵelementStart(45, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function TodoDetailComponent_div_0_Template_button_click_45_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.deleteTodo();\n    });\n    i0.ɵɵelement(46, \"i\", 24);\n    i0.ɵɵtext(47, \" Delete \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate(ctx_r0.todo.title);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.todo.description || \"No description provided\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.todo.id, \" \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(12, _c0, ctx_r0.todo.completed, !ctx_r0.todo.completed));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.todo.completed ? \"Completed\" : \"Pending\", \" \");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(31, 9, ctx_r0.todo.createdDate, \"medium\"), \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.todo.completed && ctx_r0.todo.completedDate);\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.todo.completed);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.todo.completed);\n  }\n}\n\nfunction TodoDetailComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵtext(1, \" Loading todo details...\\n\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TodoDetailComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.errorMessage, \"\\n\");\n  }\n}\n\nexport let TodoDetailComponent = /*#__PURE__*/(() => {\n  class TodoDetailComponent {\n    constructor(todoService, route, router) {\n      this.todoService = todoService;\n      this.route = route;\n      this.router = router;\n      /**\r\n       * The todo being viewed/edited\r\n       */\n\n      this.todo = {\n        id: 0,\n        title: '',\n        description: '',\n        completed: false,\n        createdDate: null,\n        completedDate: null\n      };\n      /**\r\n       * Flag to track if we're in edit mode\r\n       */\n\n      this.editMode = false;\n      /**\r\n       * ID of the todo being viewed/edited\r\n       */\n\n      this.todoId = 0;\n      /**\r\n       * Loading state indicator\r\n       */\n\n      this.loading = false;\n      /**\r\n       * Error message to display in the template\r\n       */\n\n      this.errorMessage = null;\n    }\n\n    ngOnInit() {\n      // Get the todo ID from the route parameters using the modern approach\n      this.route.paramMap.pipe(take(1), // Take only the first emission and complete\n      switchMap(params => {\n        const id = params.get('id');\n\n        if (id) {\n          this.todoId = +id;\n          this.loading = true;\n          this.errorMessage = null;\n          return this.loadTodo(this.todoId);\n        } else {\n          // Handle case where no ID is provided\n          this.errorMessage = 'No todo ID provided in route.';\n          this.router.navigate(['/todos']);\n          return EMPTY;\n        }\n      }), catchError(error => {\n        console.error('Error in route parameter processing:', error);\n        this.errorMessage = 'Error processing route parameters.';\n        this.router.navigate(['/todos']);\n        return EMPTY;\n      }), finalize(() => this.loading = false)).subscribe();\n    }\n    /**\r\n     * Load the todo details from the server\r\n     * @param id The ID of the todo to load\r\n     * @returns An observable of the todo\r\n     */\n\n\n    loadTodo(id) {\n      return this.todoService.getById(id).pipe(catchError(error => {\n        console.error('Error loading todo:', error);\n        this.errorMessage = 'Failed to load todo details. Check console for details.';\n        this.router.navigate(['/todos']);\n        return EMPTY;\n      }), tap(todo => {\n        this.todo = todo;\n        this.errorMessage = null;\n      }));\n    }\n    /**\r\n     * Toggle the completed status of the todo\r\n     */\n\n\n    toggleStatus() {\n      const originalStatus = this.todo.completed;\n      this.todo.completed = !this.todo.completed;\n      this.errorMessage = null;\n      this.todoService.toggleTodoStatus(this.todo.id).pipe(catchError(error => {\n        console.error('Error toggling todo status:', error);\n        this.errorMessage = 'Failed to update todo status. Check console for details.'; // Revert to original status on error\n\n        this.todo.completed = originalStatus;\n        return EMPTY;\n      })).subscribe(updatedTodo => {\n        // Update the local todo with the response from the server\n        this.todo = Object.assign({}, updatedTodo);\n        this.errorMessage = null;\n      });\n    }\n    /**\r\n     * Enable edit mode for this todo by navigating to the edit route\r\n     */\n\n\n    editTodo() {\n      this.router.navigate(['/todos', this.todoId, 'edit']);\n    }\n    /**\r\n     * Update the todo with current values\r\n     */\n\n\n    updateTodo() {\n      if (!this.todo.title) {\n        this.errorMessage = 'Title is required!';\n        return;\n      }\n\n      this.loading = true;\n      this.errorMessage = null;\n      this.todoService.updateTodo(this.todo).pipe(catchError(error => {\n        console.error('Error updating todo:', error);\n        this.errorMessage = 'Failed to update todo. Check console for details.';\n        return EMPTY;\n      }), finalize(() => this.loading = false)).subscribe(updatedTodo => {\n        this.todo = updatedTodo;\n        this.editMode = false;\n        this.errorMessage = null;\n      });\n    }\n    /**\r\n     * Delete the current todo\r\n     */\n\n\n    deleteTodo() {\n      if (confirm('Are you sure you want to delete this todo?')) {\n        this.loading = true;\n        this.errorMessage = null;\n        this.todoService.deleteTodo(this.todo.id).pipe(catchError(error => {\n          console.error('Error deleting todo:', error);\n          this.errorMessage = 'Failed to delete todo. Check console for details.';\n          return EMPTY;\n        }), finalize(() => this.loading = false)).subscribe(() => {\n          // Navigate back to the todo list after successful deletion\n          this.router.navigate(['/todos']);\n        });\n      }\n    }\n    /**\r\n     * Cancel editing and revert to view mode\r\n     */\n\n\n    cancelEdit() {\n      this.editMode = false;\n      this.errorMessage = null; // Reload the todo to discard any changes\n\n      this.loading = true;\n      this.loadTodo(this.todoId).pipe(finalize(() => this.loading = false)).subscribe();\n    }\n    /**\r\n     * Navigate back to the todo list\r\n     */\n\n\n    goBack() {\n      this.router.navigate(['/todos']);\n    }\n\n  }\n\n  TodoDetailComponent.ɵfac = function TodoDetailComponent_Factory(t) {\n    return new (t || TodoDetailComponent)(i0.ɵɵdirectiveInject(i1.TodoService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router));\n  };\n\n  TodoDetailComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TodoDetailComponent,\n    selectors: [[\"app-todo-detail\"]],\n    decls: 3,\n    vars: 3,\n    consts: [[\"class\", \"todo-detail-container\", 4, \"ngIf\"], [\"class\", \"alert alert-info\", 4, \"ngIf\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [1, \"todo-detail-container\"], [1, \"card\"], [1, \"card-header\", \"d-flex\", \"justify-content-between\", \"align-items-center\"], [1, \"card-body\"], [1, \"title\"], [1, \"description\"], [1, \"\"], [1, \"status-badge\", 3, \"ngClass\"], [1, \"dates\", \"mt-4\"], [1, \"row\"], [1, \"col-md-6\"], [\"class\", \"col-md-6\", 4, \"ngIf\"], [1, \"card-footer\"], [1, \"d-flex\", \"justify-content-between\"], [1, \"btn\", \"btn-primary\", \"me-2\", 3, \"click\"], [1, \"fa\", \"fa-arrow-left\"], [1, \"btn\", \"btn-warning\", \"me-2\", 3, \"click\"], [1, \"fa\", \"fa-edit\"], [\"class\", \"btn btn-success me-2\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"btn btn-secondary me-2\", 3, \"click\", 4, \"ngIf\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"fa\", \"fa-trash\"], [1, \"btn\", \"btn-success\", \"me-2\", 3, \"click\"], [1, \"fa\", \"fa-check\"], [1, \"btn\", \"btn-secondary\", \"me-2\", 3, \"click\"], [1, \"fa\", \"fa-undo\"], [1, \"alert\", \"alert-info\"], [1, \"alert\", \"alert-danger\"]],\n    template: function TodoDetailComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, TodoDetailComponent_div_0_Template, 48, 15, \"div\", 0);\n        i0.ɵɵtemplate(1, TodoDetailComponent_div_1_Template, 2, 0, \"div\", 1);\n        i0.ɵɵtemplate(2, TodoDetailComponent_div_2_Template, 2, 1, \"div\", 2);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.todo);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.todo && !ctx.errorMessage);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n      }\n    },\n    styles: [\".todo-detail-container[_ngcontent-%COMP%]{width:60%;margin:auto}.card-header[_ngcontent-%COMP%]{background-color:#337ab7;color:#fff}.todo-detail-card[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:4px;padding:20px;margin-bottom:20px;box-shadow:0 2px 4px #0000001a}.todo-detail-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;background-color:#337ab7}.todo-detail-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:4px;font-size:12px;font-weight:bold;margin-left:1%}.status-badge.completed-card[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status-badge.pending-card[_ngcontent-%COMP%]{background-color:#fff3cd;color:#f0ad4e}.todo-description[_ngcontent-%COMP%]{margin:15px 0;line-height:1.5;color:#555}.todo-metadata[_ngcontent-%COMP%]{font-size:.9em;color:#666;margin-top:15px}.todo-metadata[_ngcontent-%COMP%]   .metadata-item[_ngcontent-%COMP%]{margin-bottom:5px}.action-buttons[_ngcontent-%COMP%]{margin-top:20px;display:flex;grid-gap:10px;gap:10px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;cursor:pointer;font-weight:500}.action-buttons[_ngcontent-%COMP%]   button.edit-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none}.action-buttons[_ngcontent-%COMP%]   button.edit-button[_ngcontent-%COMP%]:hover{background-color:#0069d9}.action-buttons[_ngcontent-%COMP%]   button.back-button[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff;border:none}.action-buttons[_ngcontent-%COMP%]   button.back-button[_ngcontent-%COMP%]:hover{background-color:#5a6268}.action-buttons[_ngcontent-%COMP%]   button.delete-button[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none}.action-buttons[_ngcontent-%COMP%]   button.delete-button[_ngcontent-%COMP%]:hover{background-color:#c82333}\"]\n  });\n  return TodoDetailComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}